**참고**<br>
**도메인이 가장 중요하다**.<br>
도메인 = 화면, UI, 기술 인프라 등등의 영역은 제외한 시스템이 구현해야 하는 핵심 비즈니스 업무 영역을
말함<br>
향후 web을 다른 기술로 바꾸어도 도메인은 그대로 유지할 수 있어야 한다.<br>
이렇게 하려면 web은 domain을 알고있지만 domain은 web을 모르도록 설계해야 한다. 이것을 web은 <br>
domain을 의존하지만, domain은 web을 의존하지 않는다고 표현한다. 예를 들어 web 패키지를 모두 <br>
삭제해도 domain에는 전혀 영향이 없도록 의존관계를 설계하는 것이 중요하다. 반대로 이야기하면 <br>
domain은 web을 참조하면 안된다.<br>

### 쿠키 사용해서 로그인 처리
1. 로그인 요청시 HttpServletResponse 를 이용하여 addCookie 해준다.
2. 이렇게 되면 응답시 set-cookie라는 헤더가 응답 헤더에 실린다.
3. 그 헤더를 보고 브라우저는 브라우저 쿠키 저장소에 저장한다.
4. 브라우저는 매 요청시 요청 헤더에 쿠키를 실어 보내준다.
5. 헌데, 이렇게 하면 정말 심각한 보안 문제가 있다.

### 쿠키와 보안 문제

**보안 문제**<br>
- 쿠키 값은 임의로 변경할 수 있다.
  - 클라이언트가 쿠키를 강제로 변경하면 다른 사용자가 된다.
- 쿠키에 보관된 정보는 훔쳐갈 수 있다.
  - 만약 쿠키에 개인정보나, 신용카드 정보가 있다면?
  - 이 정보가 웹 브라우저에도 보관되고, 네트워크 요청마다 계속 클라이언트에서 서버로 전달된다.
  - 쿠키의 정보가 나의 로컬 PC가 털릴 수도 있고, 네트워크 전송 구간에서 털릴 수도 있다. 
- 해커가 쿠키를 한번 훔쳐가면 평생 사용할 수 있다.
  - 해커가 쿠키를 훔쳐가서 그 쿠키로 악의적인 요청을 계속 시도할 수 있다.<br>
  
**대안**<br>
- 쿠키에 중요한 값을 노출하지 않고, 사용자 별로 예측 불가능한 임의의 토큰(랜덤 값)을 노출하고, 서버에서<br>
  토큰과 사용자 id를 매핑해서 인식한다. 그리고 서버에서 토큰을 관리한다.
- 토큰은 해커가 임의의 값을 넣어도 찾을 수 없도록 예상 불가능 해야 한다.<br>
  해커가 토큰을 털어가도 시간이 지나면 사용할 수 없도록 서버에서 해당 토큰의 만료시간을 짧게(예: 30분)<br>
  유지한다. 또는 해킹이 의심되는 경우 서버에서 해당 토큰을 강제로 제거하면 된다.<br>
